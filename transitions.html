<!DOCTYPE html>
<html>
  <head>
    <title>Playing with Transitions</title>
    <meta charset="utf-8">
    <script src="/src/d3.min.js"></script>
  </head>
  <body>
    <div id="content">
      <h1>Playing with transtions</h1>
      <button id="transform">Transform!</button>
      <div id="canvas"></div>
    </div>
    <script>
      var svg = d3.select('#canvas').append('svg')
                  .attr('width', 800)
                  .attr('height', 800);

      var rect = svg.append('rect')
                .attr('fill', 'red')
                .attr('x', 0)
                .attr('y', 0)
                .attr('width', 100)
                .attr('height', 100);

      d3.select('#transform').on('click', function() {
                rect
                .transition()
                .duration(1000)
                .delay(1000)
                .ease('elastic')
                .attr('x', 400)
                .each('start', function() {
                  d3.select(this)
                    .attr('rx', 0)
                    .attr('ry', 0)
                    .attr('opacity', 1);
                })
                .each('end', function() {
                  d3.select(this)
                    .transition()
                    .duration(1000)
                    .attr('rx', 50)
                    .attr('ry', 50)
                    .attr('fill', 'green')
                    .each('end', function() {
                      d3.select(this)
                        .transition(1000)
                        .duration(2000)
                        .attr('opacity', 0)
                        .remove()
                    });
                });
      });

    </script>
  </body>
</html>
